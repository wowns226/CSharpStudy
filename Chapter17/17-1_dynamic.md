# dynamic

## dynamic이란?
dynamic 형식은 데이터 형식이다.<br>
형식 검사를 하는 시점이 프로그램 실행 중이라는 점이 다르다.

### 덕 타이핑
> 오리처럼 걷고 오리처럼 헤엄치며 오리처럼 우는 새를 봤을 때, 나는 그 새를 오리라고 부른다.

상속을 받지 않아도 기본 클래스와 동일하게 동작하는 클래스는 기본 클래스의 형식이라고 본다.<br>
dynamic 형식으로 선언하면 형식 검사를 실행할 때로 미룬다.<br>
* 장점
    - 상속관계를 이용하지 않기 때문에 프로그램의 동작 관련 부분만 수정하면 된다.
* 단점
    - VS의 리팩터링 기능을 이용하지 못한다.
* [[Code]](/Code/Chapter17/DuckTyping.cs)

## COM과 .NET 사이의 상호 운용성을 위한 dynamic 형식
COM은 부품 역할을 하는 S/W이다.<br>
COM 컴포넌트는 그래픽 프로그래밍에 화려한 차트 기능을 애플리케이션에 넣을 수 있도록 해주고, 엑셀 문서를 읽거나 쓸 수 있게 해준다.<br>
C#을 비롯한 .NET 언어들은 RCW(Runtime Callable Wrapper)를 통해서 COM 컴포넌트를 사용할 수 있다.<br>
RCW는 .NET이 제공하는 Type Library Importer(tlbimp.exe)를 이용해서 만들 수 있다. <br>
VS를 이용해 COM 객체를 프로젝트 참조에 추가하면 자동으로 tlbimp.exe를 호출해 RCW를 만들어준다.<br>
RCW는 COM에 대한 프록시 역할을 함으로써 C#코드에서 .NET 클래스 라이브를 사용하듯 COM API를 사용할 수 있게 해준다.
* [[Code]](/Code/Chapter17/COMInterop.cs)
* 엑셀과 VS가 깔려 있어야 한다.

## 동적 언어와의 상호 운용성을 위한 dynamic 형식
CLR은 IL로 컴파일할 수 있는 언어들은 지원하지만, 동적 언어는 지원하지 않는다.<br>
DLR은 CLR 위에서 동작하며, 동적 언어를 실행할 수 있다.<br>
* 장점
    - 동적 언어를 .NET 플랫폼에서 샐행할 수 있다.
    - 동적 언어에서 만들어진 객체에 C#이나 VB같은 정적 언어의 코드에서 접근할 수 있게 해준다.
    - C# 프로그래머는 별도의 학습 없이도 바로 라이브러리를 이용하는 코드를 호스팅할 수 있다.
        + 호스팅 : 주인이 손님을 섬긴다는 의미이다.<br> CLR이 주인이고 위에 얹혀 동작하는 동적 언어가 손님이다.
    - dynamic을 이용해 CLR과 DLR 사이의 상호 운용성 문제를 해결하는 데 사용할 수 있다.

|    클래스     |                                                                                            설명                                                                                            |
| :-----------: | :----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------: |
| ScriptRuntime | 동적 언어를 호스팅하는 시작점이다. ScriptRuntime 클래스는 참조된 어셈블리나 전역 객체같은 전역 상태를 나타내며 하나의 .NET AppDomain 안에 여러 개의 ScriptRuntime 인스턴스를 만들 수 있다. |
|  ScriptScope  |                             기본적으로 네임스페이스를 나타낸다.호스트는 ScriptScope 객체 안의 동적 언어 코드에서 사용하는 변수에 값을 대입하거나 읽을 수 있다.                             |
| ScriptEngine  |                                       언어의 구문을 나타내는 일꾼이다. 코드를 실행하고 ScriptScope와 ScriptSource를 생성하는 다양한 방법을 제공한다.                                       |
| ScriptSource  |                                          소스 코드를 읽어들이는 여러 메소드와 읽어들인 소스 코드를 다양한 방법으로 실행하는 메소드들을 제공한다.                                           |
| CompiledCode  |                                            컴파일된 코드를 나타낸다. 한 번 컴파일해놓고 여러 번 반복해서 실행하는 코드를 나타내는 데 사용한다.                                             |

* [[Code]](/Code/Chapter17/WithPython.cs)